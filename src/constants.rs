use crate::{Fr, Mds};
use bn::arith::U256;

pub const T: usize = 3;
pub const RATE: usize = 2;

pub const FULL_ROUNDS: usize = 8;
pub const PARTIAL_ROUNDS: usize = 57;

// just a reminder
// pub const HASHABLE_DOMAIN_SPEC: Fr = Fr::from_raw([0, 1, 0, 0]);

/// Default number of bytes to pack into a field element.
pub const POSEIDON_HASH_BYTES_IN_FIELD: usize = 31;

pub const EMPTY_HASH: Fr = Fr::new_mul_factor(U256([
    292685328690803195204103490385143548004, 43329514113177980720207163548063884417
]));

pub const EMPTY_HASH_BYTES: [u8; 32] = [
    32, 152, 245, 251, 158, 35, 158, 171, 60, 234, 195, 242, 123, 129, 228, 129, 220, 49, 36, 213,
    95, 254, 213, 35, 168, 57, 238, 132, 70, 182, 72, 100,
];

pub const ROUND_CONSTANTS: [[Fr; T]; 65] = [
    [
        Fr::new_mul_factor(U256([
            27605358067817763868800859367013191278,
            19822355331674857159645964552348372001,
        ])),
        Fr::new_mul_factor(U256([
            181413839060378673446004266621795231844,
            1252729260164630546943158074354703309,
        ])),
        Fr::new_mul_factor(U256([
            64837031283699899175304351011954455541,
            11796640534856877040428503203659284665,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            115327794255961588395505720568131092944,
            62680077361062608323728051541377749960,
        ])),
        Fr::new_mul_factor(U256([
            243767912723536904771004704523120897266,
            57379457532516555934219541943398916660,
        ])),
        Fr::new_mul_factor(U256([
            118730983795057197737678416135844863226,
            4121717916595114118396403119962969301,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            266799666565857777641249213056752833133,
            53840179430162413924492175179475363387,
        ])),
        Fr::new_mul_factor(U256([
            42802827344734930873869494178213907320,
            52044485189609043426337391746083836941,
        ])),
        Fr::new_mul_factor(U256([
            147522650846914944412914596181268284978,
            46931961698991660677600343675932808397,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            227384473140719084486204984956630324264,
            28854348212858775265601354025607690080,
        ])),
        Fr::new_mul_factor(U256([
            188825877709637077514930109069694390774,
            18323510941573292124609632944541637859,
        ])),
        Fr::new_mul_factor(U256([
            311447990303523659936705177866395864476,
            36956619084466586159976566776586548583,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            265085646119782214547135417042255865177,
            21693640230422384540882316188791587661,
        ])),
        Fr::new_mul_factor(U256([
            54759453463731959317363060703568996342,
            41773490193109847523344695397778701044,
        ])),
        Fr::new_mul_factor(U256([
            340245292934629360755302137581257131781,
            39328199926923553009079844086285994139,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            222240678087797045625908394026813869181,
            6476626492178933427198490251068942747,
        ])),
        Fr::new_mul_factor(U256([
            178867508486523207895969893675956955176,
            8571702981524394028906207613908004628,
        ])),
        Fr::new_mul_factor(U256([
            16753550168636281795091080256222426553,
            12759150806431260279028107479182466399,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            96889345017064198075088371022698356646,
            6878376289220715250993930453394474644,
        ])),
        Fr::new_mul_factor(U256([
            173954062268384340477794112561341681116,
            15346764962643577896073555568368392623,
        ])),
        Fr::new_mul_factor(U256([
            98037650888249986099975756460976160209,
            23402119355521125735914444903987021767,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            58874476127629661551969529631737548041,
            4096955218670053483631192080146398083,
        ])),
        Fr::new_mul_factor(U256([
            110933092178649210457387242375654319461,
            59514596885512000697854171049786675765,
        ])),
        Fr::new_mul_factor(U256([
            87857777549502723251458832785217417465,
            416404612961586762417436086849811318,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            133471958018642157670381319546996946613,
            46783728225287476182845111475640252753,
        ])),
        Fr::new_mul_factor(U256([
            46541135279085048499969464906026451584,
            7689567663232547074848241441862303331,
        ])),
        Fr::new_mul_factor(U256([
            109977783612164945241029236965304682075,
            13931534699648282225840353021022302802,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            320795082324505355087046692780015374016,
            56428404146738610312101749060502631131,
        ])),
        Fr::new_mul_factor(U256([
            313827346069746540961196781349215716448,
            35607154450879520598505947459528236483,
        ])),
        Fr::new_mul_factor(U256([
            51337502683936161555057442955901616064,
            24924071594477547728373502041311343737,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            109744602151801721549303587754411139726,
            15226201455346594113157867139334303823,
        ])),
        Fr::new_mul_factor(U256([
            165510916575219284185359414763773199432,
            4632345947663452383925836941579827345,
        ])),
        Fr::new_mul_factor(U256([
            283293914436576659541300137614414066799,
            7510680185619877438951018167686758043,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            85687997982521234653923190810541282926,
            55368501850606533165863954136775433988,
        ])),
        Fr::new_mul_factor(U256([
            146944343935393224976253080558649725487,
            42886304237524637831042551938962486658,
        ])),
        Fr::new_mul_factor(U256([
            248985936779292139578879707453445032071,
            61205027732897027274876125885677117425,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            31248151563725470713507162321579766216,
            26915915368949357075079132776243538757,
        ])),
        Fr::new_mul_factor(U256([
            330152649029803645175108041681964485361,
            16474101717288039833229262644642845645,
        ])),
        Fr::new_mul_factor(U256([
            307462924365175046547183836695191870035,
            3375973508000340676609524082455871322,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            141457868636057972511447811650135646988,
            61554457498007845495505443914015539442,
        ])),
        Fr::new_mul_factor(U256([
            182300020794591269642889615532604604430,
            673890329565460291995603683669102139,
        ])),
        Fr::new_mul_factor(U256([
            300785116511271794800373075775884147512,
            62255330749034371887106682197119590494,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            69496990427586980234522831140559213062,
            64221442320035183586762609084554994416,
        ])),
        Fr::new_mul_factor(U256([
            319851036235941185956823714737454761645,
            37546167692282097409480478280344884921,
        ])),
        Fr::new_mul_factor(U256([
            261087875840505378968791444130105178476,
            22206965909192357645998849988011890926,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            294429031480419223045070720302573661679,
            55960031969487846512493435683816090301,
        ])),
        Fr::new_mul_factor(U256([
            247584914490470789435718538014328970385,
            37825525528569271688499199909366781277,
        ])),
        Fr::new_mul_factor(U256([
            210429158829766433483857634459180418720,
            9736829989764994609446437141652446027,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            53648939858659800646118002420842497872,
            44318429257752838701856510072510198100,
        ])),
        Fr::new_mul_factor(U256([
            251100617955060876533539881081717475998,
            62597039634819208443933015913346248464,
        ])),
        Fr::new_mul_factor(U256([
            201324254952356637047378786999460852494,
            60186472938245897605808622958010265788,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            233581364221769738112776597392550297259,
            29488722372052301004311559349037494929,
        ])),
        Fr::new_mul_factor(U256([
            286658138540704505011357473381874742033,
            57555032763176274394169447353940249882,
        ])),
        Fr::new_mul_factor(U256([
            145814923949757759112029565443423580282,
            59232357529482714248836695756462642295,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            210160201279226193161508003071441280425,
            39125020954237846873698363734905678617,
        ])),
        Fr::new_mul_factor(U256([
            332175488017312178475333116021769131305,
            42924966073827718950516912729580343613,
        ])),
        Fr::new_mul_factor(U256([
            211074706200645321469632845716584514818,
            16349120205305692261959792672590543919,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            40356017451158395890615719972419959636,
            30960816372449739312426891768123437104,
        ])),
        Fr::new_mul_factor(U256([
            311922868104116157121761786120443056879,
            35339248723830062802542133729689849314,
        ])),
        Fr::new_mul_factor(U256([
            6813187363375187054628403613860930314,
            8541423585336882458215734553853609215,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            74586175555323518716655070366928721924,
            56223808454801801560153811731786161467,
        ])),
        Fr::new_mul_factor(U256([
            125541939791754553222869654909254358601,
            26144128930165001557256277935316069833,
        ])),
        Fr::new_mul_factor(U256([
            257456466125125744092600372768191310490,
            22769949515777107620461090273506109289,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            221717048819036666644922014937524981745,
            1243011523932841119857842687383403895,
        ])),
        Fr::new_mul_factor(U256([
            85135321566453006293347427519389997011,
            18802772191947774570634534693837492710,
        ])),
        Fr::new_mul_factor(U256([
            76237274411929586322443682599008123529,
            55771573295359392949425868486525442190,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            119725566121784734189718974508982838718,
            56278973459692458558753025293593460104,
        ])),
        Fr::new_mul_factor(U256([
            322577478384917843709865604284722944753,
            37900557974748267641745173962881877001,
        ])),
        Fr::new_mul_factor(U256([
            175338156243302009848522408990234319301,
            28053967188475905740499732896446161003,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            225912613198993688191724529908624519424,
            6345483542112207647851604754456091971,
        ])),
        Fr::new_mul_factor(U256([
            100365924337354183794552359524029442407,
            26187264911991039206308249581695757651,
        ])),
        Fr::new_mul_factor(U256([
            59666758041641145152979895639677118692,
            2189956902598523933487069107480263546,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            99163385944890902508547973257761667842,
            56758743165683984214952354529166464267,
        ])),
        Fr::new_mul_factor(U256([
            229538036564561486090622913019272214086,
            38950314253451731792389683841100469779,
        ])),
        Fr::new_mul_factor(U256([
            246100370617791968927942261858416045853,
            5413391824351107753966413300593458475,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            203317226841944931520079802702487887814,
            28302105894189769211082349978874478664,
        ])),
        Fr::new_mul_factor(U256([
            107269776234800744162702772603686899108,
            14889510428551389428183534511875618064,
        ])),
        Fr::new_mul_factor(U256([
            203293494273274537616040791774150117422,
            12409034134066777273319825028875498565,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            225506403885409343784924897111164929574,
            8579832057749875062921959268273969852,
        ])),
        Fr::new_mul_factor(U256([
            75628259038876156534616593790056560635,
            20068017001528911500610637196006376056,
        ])),
        Fr::new_mul_factor(U256([
            100633920365349593741992953748418686483,
            6599060235130973604435102931283027486,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            180868044221049583873678756462572812120,
            57606408064258197900647730170804686339,
        ])),
        Fr::new_mul_factor(U256([
            188852004496712056094241977782371297775,
            24213827436630939928127726344676776907,
        ])),
        Fr::new_mul_factor(U256([
            225355870848632812132894189400941683689,
            44236830701878914183265902175231519438,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            133579284503618447446033438264431207757,
            21081360998592826285479633066103351849,
        ])),
        Fr::new_mul_factor(U256([
            251140741620830080069931533695669285362,
            24212866956142148505319788073438381780,
        ])),
        Fr::new_mul_factor(U256([
            220996920445397050485778963667947683893,
            45053335021447805690079456666665011688,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            241189455979867026088885201382827864391,
            29431096500962190720051951469126272098,
        ])),
        Fr::new_mul_factor(U256([
            228305726951478506269177874631354239682,
            41184739477038384451519887395926000504,
        ])),
        Fr::new_mul_factor(U256([
            282340660658086406577081017345352701594,
            10521510536512284641256970469373375367,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            134330432347740317537672830601669640380,
            7522440977844659054094764774589619043,
        ])),
        Fr::new_mul_factor(U256([
            84364941902242785836481076503636011071,
            43783220647435525871857772353659243948,
        ])),
        Fr::new_mul_factor(U256([
            145953163338157575941552446111780952937,
            6153822424516347066086357723373252963,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            251324953489964957330638996041420836890,
            53047375625282214228310230690955599340,
        ])),
        Fr::new_mul_factor(U256([
            146263881046370827892676681014674580689,
            63713731263794313703601568347722498550,
        ])),
        Fr::new_mul_factor(U256([
            197917784407068709367679789235199537848,
            40997330732258147728594364869259730163,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            229164684502395459002642750168531102490,
            28517039517310308036589851768413054478,
        ])),
        Fr::new_mul_factor(U256([
            158263567724384573941917546104925243269,
            35453820864475756190849845578830836741,
        ])),
        Fr::new_mul_factor(U256([
            174368655782730894754228810565870320759,
            49872584028350461834665421237347775319,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            111280895091675242127956635612494457447,
            28773155301686195087955199138645667315,
        ])),
        Fr::new_mul_factor(U256([
            293709070689878816471817407895699920679,
            47944806736240234780764826587637700966,
        ])),
        Fr::new_mul_factor(U256([
            95588431852256412822262005315811363995,
            241108205427162932065447425231737574,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            233357693225199598819757167175182521810,
            63760037569473085061669151003752070353,
        ])),
        Fr::new_mul_factor(U256([
            61918828904535039998537108653637188798,
            963234099612154328965205796151086360,
        ])),
        Fr::new_mul_factor(U256([
            38070090791665521407369250636136461586,
            13538010742311563168017965806813990401,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            20403778901868225128929184424971540877,
            189545937615604067792470620930023062,
        ])),
        Fr::new_mul_factor(U256([
            76355781167889984698544269875187797417,
            30724567391572814928486361977078090906,
        ])),
        Fr::new_mul_factor(U256([
            128651204257937355695173347652784138248,
            30625775942212956140332675902010227415,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            271452702675184572931781974086018398945,
            55389541651771633468091144430086796142,
        ])),
        Fr::new_mul_factor(U256([
            307119517550550418186374524561435019635,
            40685570029343960261373102568916946247,
        ])),
        Fr::new_mul_factor(U256([
            338510990767291772787981168700998782729,
            39640133505764482756685179346665278298,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            165890039838617490952557273296153128760,
            46261996853090308166981951102188340638,
        ])),
        Fr::new_mul_factor(U256([
            336550747497819029639412836257289129725,
            19856699916232811873110166265400410062,
        ])),
        Fr::new_mul_factor(U256([
            25384666550415868525484325640415904388,
            23098541576521415513675148832076720261,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            338690131886010494503465921917740558767,
            23130909660161855246444873035699460023,
        ])),
        Fr::new_mul_factor(U256([
            31235545630861477592553443007360066662,
            61005138244745262543564437271192277979,
        ])),
        Fr::new_mul_factor(U256([
            325800693116216448345665461429577312685,
            63838870282247209525058099820123171869,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            55266778530232486195329668599791243398,
            57095139857058628193701239887711137602,
        ])),
        Fr::new_mul_factor(U256([
            179573865979790645157538044593129924547,
            23419374373864702401416764745599190491,
        ])),
        Fr::new_mul_factor(U256([
            240685204301659042855894863375362938880,
            32180386000096346192156091980851852599,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            278238207411755599397346199099340418742,
            53335804854532419141677317513768286752,
        ])),
        Fr::new_mul_factor(U256([
            178513821355240426659312903582393353447,
            10960887499297170611153952061540315136,
        ])),
        Fr::new_mul_factor(U256([
            23601219610966555620622895554280542523,
            15200624253890555434766423936731347944,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            117746076666300996944607948790726741851,
            19649778970568338402442715128249391764,
        ])),
        Fr::new_mul_factor(U256([
            314798072866805516993772442139029505425,
            57090566501956139602156251836450738498,
        ])),
        Fr::new_mul_factor(U256([
            69569239542104749994933367379917402488,
            15047318284799362686672337489271377527,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            213701527282943195658676670568050859328,
            14857477075046622964008158709625825582,
        ])),
        Fr::new_mul_factor(U256([
            116584154430021817007314252463648105172,
            41834605600583449248943352351574741993,
        ])),
        Fr::new_mul_factor(U256([
            11328321734477228759069815896546492979,
            1920735781299077046368435484107440149,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            160895018496638950101088798103852976243,
            16184677965908228182854700399977720731,
        ])),
        Fr::new_mul_factor(U256([
            165803985823734855544774355559421288845,
            23110815106792218101410818123763231543,
        ])),
        Fr::new_mul_factor(U256([
            53399417929532835748206239653699853248,
            62579381322112197058517529956270485775,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            250271898501962747908063490625672302523,
            40458116098149178984255711141944939713,
        ])),
        Fr::new_mul_factor(U256([
            286124904555689916794885008841096267893,
            2380909535241879031949319366583351298,
        ])),
        Fr::new_mul_factor(U256([
            138252814635485163556164023090763359502,
            41825035071421889432308140376975352796,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            44757936419525524467280697581499707417,
            49361666548539488284419135033779026857,
        ])),
        Fr::new_mul_factor(U256([
            69248584824407174319897417614108022619,
            47773002503976988421770313088596541315,
        ])),
        Fr::new_mul_factor(U256([
            123722824389749379250354702450843725145,
            58162457308337239781758051950266340712,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            130550294158419175492221496783155634271,
            20707016157087879279451914305921498833,
        ])),
        Fr::new_mul_factor(U256([
            31773512021898428335969247489384902824,
            47024866418278452677200887740741218638,
        ])),
        Fr::new_mul_factor(U256([
            239932678447040453225780159465880324424,
            28615282687706184068376218464112551262,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            72023958766746616506678664612409983503,
            33533606781247817146287767965419642272,
        ])),
        Fr::new_mul_factor(U256([
            78665321264588805842429819689656364559,
            56125042996090947704039798040421904752,
        ])),
        Fr::new_mul_factor(U256([
            182336936944937559472039893472714477890,
            32366614498451008242472341515812491666,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            57248888956966415719775556834772833067,
            6485667407033353514146772915469283728,
        ])),
        Fr::new_mul_factor(U256([
            235349782993221831026316794041948200739,
            21076288304682551143899363657742453851,
        ])),
        Fr::new_mul_factor(U256([
            156768555287162832531577800792623870400,
            7376926178188169267428237873107610978,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            47461329998806597131629487717291435418,
            25935153811089352691125779786106008875,
        ])),
        Fr::new_mul_factor(U256([
            169319358889590370912347783772933580981,
            4352636866569411836862761263395090622,
        ])),
        Fr::new_mul_factor(U256([
            148596809966180361881221017474285636184,
            47809366997694884377639538171973728316,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            32919158746034412580930087169188389618,
            13757666888824985598493569643885223631,
        ])),
        Fr::new_mul_factor(U256([
            301427996305764500828440520072057835643,
            9202469602448238831213033037721763132,
        ])),
        Fr::new_mul_factor(U256([
            234708712591832701907018007751673486593,
            23305357966593092156863684542388928200,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            110163358940141737053369491134620443057,
            26369721118832289445333674269432699373,
        ])),
        Fr::new_mul_factor(U256([
            295193622405646541013519262550452127611,
            30043106211802432039047163616540480027,
        ])),
        Fr::new_mul_factor(U256([
            78085333881442100347734303076617573453,
            6559520867613228736920174116924702937,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            34458059517051101216475135157054958060,
            49753062133643980109849850998924455483,
        ])),
        Fr::new_mul_factor(U256([
            156580000361542311446396373358294658738,
            63886936455739240442649568737976778831,
        ])),
        Fr::new_mul_factor(U256([
            5668121760049578406017159839941969810,
            22064954752400196200423723038002584564,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            211614064760890548131772059244285880416,
            33557116012232194630325685137884881368,
        ])),
        Fr::new_mul_factor(U256([
            278845272540483487519259566939695942493,
            32018521463362972911883382485031793479,
        ])),
        Fr::new_mul_factor(U256([
            216876651322345783267426615481562980625,
            54790333548048806032656571199629187254,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            149110898700600786365220986204160313105,
            21789092136547679510977749761288939082,
        ])),
        Fr::new_mul_factor(U256([
            63225348566817126775705770714448599035,
            15843604881387730717994495549522689811,
        ])),
        Fr::new_mul_factor(U256([
            65097685588301153966656590938087858998,
            30356867936963404802344495690977860744,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            13735485778844346689725937196051460122,
            13846499138497367534790438098819134644,
        ])),
        Fr::new_mul_factor(U256([
            235512199544071795815684905663802054752,
            35097966755179865039835890147887270142,
        ])),
        Fr::new_mul_factor(U256([
            51362929015915376766864881009427190742,
            12632759636269222920658099349529550407,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            274891824337781227256124408144602515243,
            29384549348822565146793539034578915264,
        ])),
        Fr::new_mul_factor(U256([
            97360950482782947604834153351293573643,
            14424538584990252399273920087322353258,
        ])),
        Fr::new_mul_factor(U256([
            281715743757525917435773804140579779665,
            35157310068865302547741325104257442702,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            192091456065314400444696737904637560150,
            59156506352085335848031253938636171242,
        ])),
        Fr::new_mul_factor(U256([
            246161141852902606321941278672205287280,
            37864990028905646796884287592407253527,
        ])),
        Fr::new_mul_factor(U256([
            324335150863725017574753072155116818295,
            59617571122218522032733624335326313120,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            220486397045502278118009876751635853034,
            47848630322398789119464485662536860569,
        ])),
        Fr::new_mul_factor(U256([
            233083104824160422575820023604340343405,
            12733344688548403931928802436050704848,
        ])),
        Fr::new_mul_factor(U256([
            165476694054357327373560712952795874864,
            32636756348158703721544419180379486479,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            291972449011247334113054463767551734911,
            64222941286477294781298706748398208820,
        ])),
        Fr::new_mul_factor(U256([
            144776271236800096419446553262865186168,
            28822792999413757879858445824534207554,
        ])),
        Fr::new_mul_factor(U256([
            290982560661986368756405523251716786892,
            39413763981400328110245068022694009221,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            104093488871751936205650085070732175819,
            52623493922214216194188983127150498382,
        ])),
        Fr::new_mul_factor(U256([
            39987849207982647163378201769169595744,
            42771501151124169821548973748949304048,
        ])),
        Fr::new_mul_factor(U256([
            216456345270522893579683188767001722463,
            12531112881172877372556870771464722034,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            89793680149774656980865072926111376804,
            7056212223836197930346461396201211771,
        ])),
        Fr::new_mul_factor(U256([
            287998067293825763034115992475236656625,
            36004350136408309669335247353488268985,
        ])),
        Fr::new_mul_factor(U256([
            316350991186690779228269903930423537372,
            45054292390772371606193346187715535774,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            270433873143840036074458779761811119880,
            38523402517106925264100533469313198782,
        ])),
        Fr::new_mul_factor(U256([
            59284006805806245676213586380415189248,
            20110242226181366020014519190281221046,
        ])),
        Fr::new_mul_factor(U256([
            260712586347615876148090003247318442784,
            29831411418872588734479393704208175806,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            252796259696707515019919501307021023344,
            20789558229112538562926493360684006105,
        ])),
        Fr::new_mul_factor(U256([
            281042740304696765066918086889721646010,
            33542522046335412880514215889454106638,
        ])),
        Fr::new_mul_factor(U256([
            211925920027399647970534374103838255352,
            21490258704886692516880789918026810313,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            65685847030881628209856232532463577777,
            21105053389656715645340304085352007089,
        ])),
        Fr::new_mul_factor(U256([
            60676894177021486278142881436123368738,
            44442959780751829103216877431295328078,
        ])),
        Fr::new_mul_factor(U256([
            79939034070198831964767563869169275233,
            39406222766256142664596605150612785691,
        ])),
    ],
];

pub const MDS: [[Fr; T]; T] = [
    [
        Fr::new_mul_factor(U256([
            197714796198543472330027742026967552395,
            22075034970032383254755011001830516657,
        ])),
        Fr::new_mul_factor(U256([
            195504836112990678304988582373635982304,
            30474926464185883630508565703748861116,
        ])),
        Fr::new_mul_factor(U256([
            328353944958881995403422713899325485933,
            57908300058368787177686968730175155725,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            59529639214786992276093977164587456369,
            55048457396608229727092915554051808202,
        ])),
        Fr::new_mul_factor(U256([
            245395499387895571790978698557453893155,
            61331937354107936996733203477584821697,
        ])),
        Fr::new_mul_factor(U256([
            27318257117675210740760396993161370618,
            21353035610310769478413311504372663613,
        ])),
    ],
    [
        Fr::new_mul_factor(U256([
            306789332007095235397026066235366945191,
            26834478214586148664888336754893391452,
        ])),
        Fr::new_mul_factor(U256([
            276935720164126290257174362300613536017,
            31136909467379102965407121687401921945,
        ])),
        Fr::new_mul_factor(U256([
            221006363777614280476741771635429070304,
            34082156268817137190542509478867261759,
        ])),
    ],
];
